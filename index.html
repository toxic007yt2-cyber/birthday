<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Birthday ‚ù§Ô∏è</title>

<style>
body{
margin:0;
font-family:sans-serif;
color:white;
height:100vh;
overflow:hidden;
display:flex;
align-items:center;
justify-content:center;
background:linear-gradient(120deg,#1e3c72,#ff4b2b);
}

/* canvas stars */
canvas{
position:fixed;
top:0;
left:0;
z-index:-1;
}

/* card */
.card{
background:rgba(255,255,255,.12);
backdrop-filter:blur(20px);
padding:35px;
border-radius:25px;
text-align:center;
width:min(92vw,520px);
box-shadow:0 0 40px #ff4b2b;
}

/* slideshow */
#slide{
width:170px;
height:170px;
border-radius:18px;
object-fit:cover;
cursor:pointer;
}

/* buttons */
button{
margin-top:12px;
padding:10px 18px;
border:none;
border-radius:12px;
background:linear-gradient(45deg,#ff416c,#ff4b2b);
color:white;
font-weight:bold;
cursor:pointer;
}

/* visualizer */
#visualizer{
display:flex;
gap:3px;
justify-content:center;
margin-top:8px;
}
.bar{
width:4px;
height:10px;
background:white;
}

/* puzzle */
#puzzle{
display:grid;
grid-template-columns:repeat(3,80px);
gap:8px;
justify-content:center;
margin-top:10px;
}
.tile{
width:80px;
height:80px;
background-size:240px 240px;
border-radius:10px;
cursor:pointer;
}

/* hidden message */
#secretMsg{
display:none;
margin-top:12px;
font-size:18px;
color:#fff;
}

/* popup */
.popup{
position:fixed;
top:0;left:0;
width:100%;height:100%;
display:none;
align-items:center;
justify-content:center;
background:rgba(0,0,0,.6);
}
.popup-box{
background:white;
color:black;
padding:20px;
border-radius:18px;
}
</style>
</head>

<body>

<canvas id="stars"></canvas>

<div class="card">

<img id="slide" src="photo1.jpg">

<h2>Happy Birthday Babayyy ‚ù§Ô∏è</h2>
<p id="typing"></p>

<button onclick="openLetter()">üíå Love Letter</button>
<button onclick="playMusic()">üéµ Play</button>

<div id="visualizer"></div>
<div id="count"></div>

<h3>üß© Solve My Love Puzzle</h3>
<div id="puzzle"></div>
<button onclick="shufflePuzzle()">Shuffle</button>

<div id="secretMsg">üíñ Tum meri life ka best part ho üíñ</div>

<audio id="song" src="music.mp3"></audio>
<audio id="bdayVoice" src="happy.mp3"></audio>

</div>

<!-- LOVE LETTER -->
<div id="letter" class="popup">
<div class="popup-box">
<p>
Pass nahi ho firr bhi Tumse pyaar karte hai,<br>
Dekhkar tasveer tumhari Tumhi ko yaad karte hai,<br>
Dil mein itni tadap hai ki har waqt,<br>
Tere se milne ki hi fariyaad karte hai ‚ù§Ô∏è
</p>
<button onclick="closeLetter()">Close</button>
</div>
</div>

<script>

/* typing */
let txt="You are my universe ‚ù§Ô∏è Happy Birthday üéÇ";
let i=0;
function type(){
if(i<txt.length){
typing.innerHTML+=txt[i++];
setTimeout(type,50);
}}
type();

/* slideshow */
const imgs=[
"photo1.jpg","photo2.jpg","photo3.jpg","photo4.jpg",
"photo5.jpg","photo6.jpg","photo7.jpg","photo8.jpg",
"photo9.jpg","photo10.jpg","photo11.jpg","photo12.jpg","photo13.jpg"
];
let s=0;
setInterval(()=>{
s=(s+1)%imgs.length;
slide.src=imgs[s];
},2000);

/* popup */
function openLetter(){letter.style.display="flex";}
function closeLetter(){letter.style.display="none";}

/* music */
for(let x=0;x<25;x++){
let b=document.createElement("div");
b.className="bar";
visualizer.appendChild(b);
}
let bars=document.querySelectorAll(".bar");

function playMusic(){

  const audio = document.getElementById("song");
  audio.play().catch(()=>{});

  // visualizer bars
  setInterval(()=>{
    bars.forEach(b=>{
      b.style.height=(Math.random()*60+5)+"px";
    });
  },100);

  // effects start
  heartRain();
  balloons();
}

/* countdown */
let target=new Date();
target.setDate(12);
target.setHours(0,0,0,0);

setInterval(()=>{
let diff=target-new Date();
let d=Math.floor(diff/86400000);
let h=Math.floor(diff%86400000/3600000);
let m=Math.floor(diff%3600000/60000);
let s=Math.floor(diff%60000/1000);
count.innerHTML=`${d}d ${h}h ${m}m ${s}s ‚ù§Ô∏è`;
},1000);

/* stars */
let c=stars.getContext("2d");
stars.width=innerWidth;
stars.height=innerHeight;
let arr=[];
for(let k=0;k<100;k++)
arr.push({x:Math.random()*stars.width,y:Math.random()*stars.height});

setInterval(()=>{
c.clearRect(0,0,stars.width,stars.height);
c.fillStyle="white";
arr.forEach(st=>{
c.fillRect(st.x,st.y,2,2);
st.y+=.3;
if(st.y>stars.height)st.y=0;
});
},30);

/* ===== PUZZLE ===== */
const puzzle=document.getElementById("puzzle");
let order=[0,1,2,3,4,5,6,7,8];

function draw(){
puzzle.innerHTML="";
order.forEach((n,i)=>{
let d=document.createElement("div");
d.className="tile";
d.style.backgroundImage="url(photo1.jpg)";
d.style.backgroundPosition=`-${(n%3)*80}px -${Math.floor(n/3)*80}px`;
d.onclick=()=>swap(i);
puzzle.appendChild(d);
});
if(JSON.stringify(order)==JSON.stringify([0,1,2,3,4,5,6,7,8])){
    secretMsg.style.display="block";
    openBoss();
    heartExplosion();
}

/* ===== REAL SWAP SYSTEM ===== */

let selected = null;

function swap(i){

  // first tap select
  if(selected === null){
    selected = i;
    highlight(i);
    return;
  }

  // second tap swap
  [order[selected], order[i]] =
  [order[i], order[selected]];

  selected = null;
  draw();

  checkSolved();
}


/* highlight tile */
function highlight(i){
  let tiles=document.querySelectorAll(".tile");
  tiles.forEach(t=>t.style.outline="none");
  tiles[i].style.outline="3px solid white";
}


/* solved check */
function checkSolved(){
  if(JSON.stringify(order) === JSON.stringify([0,1,2,3,4,5,6,7,8])){
    openBoss();   // unlock popup ‚ù§Ô∏è
  }
}

function shufflePuzzle(){
order.sort(()=>Math.random()-0.5);
secretMsg.style.display="none";
draw();
}

draw();
/* ===== HIDDEN BOSS HEART CLICK ===== */
const boss = document.getElementById("boss");
let heartClicks = 0;

// listen for heart click anywhere
document.addEventListener("click",(e)=>{
  if(e.target.innerText.includes("‚ù§Ô∏è")){
    heartClicks++;

    if(heartClicks >= 5){
      openBoss();
      heartClicks = 0;
    }
  }
});

function openBoss(){
  boss.style.display="flex";
  heartExplosion();
}

function closeBoss(){
  boss.style.display="none";
}

/* explosion effect */
function heartExplosion(){
for(let i=0;i<40;i++){
let h=document.createElement("div");
h.innerHTML="‚ù§Ô∏è";
h.style.position="fixed";
h.style.left=Math.random()*100+"vw";
h.style.top=Math.random()*100+"vh";
document.body.appendChild(h);

h.animate([
{transform:"scale(0)",opacity:1},
{transform:"scale(2)",opacity:0}
],{duration:900});

setTimeout(()=>h.remove(),900);
}
}
  function heartRain(){
setInterval(()=>{
let h=document.createElement("div");
h.className="float";
h.innerHTML="‚ù§Ô∏è";
h.style.left=Math.random()*100+"vw";
h.style.top="-20px";
document.body.appendChild(h);

h.animate([
{transform:"translateY(0px)"},
{transform:`translateY(${window.innerHeight}px)`}
],{duration:3000})
.onfinish=()=>h.remove();

},300);
  }
  function balloons(){
setInterval(()=>{
let b=document.createElement("div");
b.className="float";
b.innerHTML="üéà";
b.style.left=Math.random()*100+"vw";
b.style.bottom="-20px";
document.body.appendChild(b);

b.animate([
{transform:"translateY(0px)"},
{transform:"translateY(-110vh)"}
],{duration:5000})
.onfinish=()=>b.remove();

},800);
  }
</script>
<!-- SECRET BOSS SCREEN -->
<div id="boss" class="popup">
  <div class="popup-box">
    <h2>‚ù§Ô∏è You found my secret ‚ù§Ô∏è</h2>
    <p>
      No matter where you go,<br>
      You‚Äôll always be my favorite person ‚ú®
    </p>
    <button onclick="closeBoss()">Close</button>
  </div>
</div>

</body>
</html>
